<ion-content [fullscreen]="true">
  <ion-header>
    <ion-toolbar>
      <ion-title>
        <ion-row>
          <ion-col *ngIf="isDesktop()" size-md="6"
                   style="display: flex; align-items: center;">
            {{ 'app.title' | translate }}
          </ion-col>
          <ion-col *ngIf="isDesktop()" class="ion-text-end" size-md="6">
            <ion-chip (click)="allowSounds ? allowSounds = false : allowSounds = true"
                      [ngClass]="allowSounds ? '' : 'inactive-chip' "
                      class="ion-text-end">
              <ion-icon *ngIf="isDesktop()"
                        name="{{allowSounds ? 'volume-high' :  'volume-mute'}}"></ion-icon>
            </ion-chip>
            <ion-chip (click)="setLanguage('en')" [ngClass]="quiz_language === 'en' ? '' : 'inactive-chip' "
                      class="ion-text-end">
              <ion-icon class="fi fi-gb"></ion-icon>
            </ion-chip>
            <ion-chip (click)="setLanguage('de')" [ngClass]="quiz_language === 'de' ? '' : 'inactive-chip' "
                      class="ion-text-end">
              <ion-icon class="fi fi-de"></ion-icon>
            </ion-chip>
            <ion-chip (click)="setLanguage('hu')" [ngClass]="quiz_language === 'hu' ? '' : 'inactive-chip' "
                      class="ion-text-end">
              <ion-icon class="fi fi-hu"></ion-icon>
            </ion-chip>
          </ion-col>
        </ion-row>
      </ion-title>
      <ion-row *ngIf="!isDesktop()">
        <ion-col style="font-size: 14px; margin-top: 10px;">
          {{ 'app.title' | translate }}
        </ion-col>
        <ion-col *ngIf="!isDesktop()" size="1" style="margin-right: 5px;">
          <ion-chip (click)="allowSounds ? allowSounds= false : allowSounds = true"
                    [ngClass]="allowSounds ? '' : 'inactive-chip' ">
            <ion-icon
              name="{{allowSounds ? 'volume-high' :  'volume-mute'}}"
              style="font-size: 16px;"
            ></ion-icon>
          </ion-chip>
        </ion-col>
        <ion-col *ngIf="!isDesktop()" size="1" style="margin-right: 10px;">
          <ion-chip (click)="setLanguage('en')" [ngClass]="quiz_language === 'en' ? '' : 'inactive-chip' ">
            <ion-icon class="fi fi-gb mobile-ion-icon"></ion-icon>
          </ion-chip>
        </ion-col>
        <ion-col *ngIf="!isDesktop()" size="1" style="margin-right: 10px;">
          <ion-chip (click)="setLanguage('de')" [ngClass]="quiz_language === 'de' ? '' : 'inactive-chip' ">
            <ion-icon class="fi fi-de mobile-ion-icon"></ion-icon>
          </ion-chip>
        </ion-col>
        <ion-col *ngIf="!isDesktop()" size="1" style="margin-right: 18px;">
          <ion-chip (click)="setLanguage('hu')" [ngClass]="quiz_language === 'hu' ? '' : 'inactive-chip' ">
            <ion-icon class="fi fi-hu mobile-ion-icon"></ion-icon>
          </ion-chip>
        </ion-col>
      </ion-row>
    </ion-toolbar>
  </ion-header>
  <ion-alert
    [isOpen]="isAlertOpen"
    class="{{!active ? 'redalert' : 'cssalert'}}"
    header="{{active ? prizesList[level] :  'quiz.incorrect_answer' | translate }}"
  >
  </ion-alert>
  <ion-alert
    [isOpen]="isWinning"
    class="{{'cssalert'}}"
    header="{{'quiz.won' | translate: {prize: prizesList[14]} }}"
  >
  </ion-alert>
  <ion-grid>
    <ion-row>
      <ng-container *ngIf="networkError">
        <ion-header>
          <ion-toolbar>
            <ion-row>
              <ion-title color="warning">
                <ion-col>
                  <ion-icon name="cloud-offline-outline" size="large"></ion-icon>
                </ion-col>
                <ion-col>{{'app.network_error' | translate}}</ion-col>
              </ion-title>
            </ion-row>
          </ion-toolbar>
        </ion-header>
      </ng-container>
      <ion-col *ngIf="level===0 && !startBtnClicked" offset-md="2" size-md="8" style="fill: #56ab2f">
        <ion-card [ngClass]="isDesktop() ? '': 'mobileCard'">
          <ion-row *ngIf="level===0 && !startBtnClicked">
            <ion-col offset-md="4" size-md="4">
              <ion-img
                src="././assets/millionaire.png"
                style="width: auto;">
              </ion-img>
              <ion-button (click)="startQuiz()" *ngIf="level===0 && !startBtnClicked && networkError ==='' "
                          class="btn-grad"
                          color="none"
                          id="startBtn"
              >{{ 'menu.start' | translate }}

              </ion-button>
              <ion-button (click)="!showTopicActionSheet ? showTopicActionSheet = true : ''"
                          *ngIf="level===0 && !startBtnClicked && networkError ==='' "
                          class="btn-grad"
                          color="none"
              >{{ 'menu.select_topic' | translate }}
              </ion-button>
              <ion-button (click)="!showDifficultyActionSheet ? showDifficultyActionSheet = true : ''"
                          *ngIf="level===0 && !startBtnClicked && networkError ==='' "
                          class="btn-grad"
                          color="none"
              >{{ 'menu.select_difficulty' | translate }}
              </ion-button>
              <ion-button (click)="!feedbackModal ? feedbackModal = true : '';"
                          *ngIf="level===0 && !startBtnClicked && networkError ==='' "
                          class="btn-grad"
                          color="none"
              >{{ 'menu.contact' | translate }}

              </ion-button>
              <ion-action-sheet
                (didDismiss)="logResult($event)"
                [buttons]="topicActionSheetButtons"
                header="   {{ 'menu.current_topic' | translate:{topic: 'menu.topics.'+ questionTopic | translate} }}"
                isOpen='{{showTopicActionSheet}}'
              ></ion-action-sheet>
              <ion-action-sheet
                (didDismiss)="logResult($event)"
                [buttons]="difficultyActionSheetButtons"
                header="   {{ 'menu.current_difficulty' | translate:{difficulty: 'menu.difficulties.'+ questionDifficulty | translate} }}"
                isOpen='{{showDifficultyActionSheet}}'
              ></ion-action-sheet>
              <ion-modal (didDismiss)="setOpen(false)" [isOpen]="feedbackModal"
              >
                <ng-template>
                  <ion-header>
                    <ion-toolbar>
                      <ion-title>{{ 'menu.contact_tab.title' | translate }}</ion-title>
                      <ion-buttons slot="end">
                        <ion-button (click)="setOpen(false)">{{ 'menu.cancel' | translate }}</ion-button>
                      </ion-buttons>
                    </ion-toolbar>
                  </ion-header>
                  <ion-content>
                    <ion-card class="feedBackCard">
                      <ion-card-header style="font-size: 1rem; border-radius: 5px; --color: white; text-align: center">
                        {{ 'menu.contact_tab.description' | translate }}
                      </ion-card-header>
                    </ion-card>
                    <form #contactForm="ngForm" (ngSubmit)="onSubmit(contactForm)">
                      <ion-list>
                        <ion-item>
                          <ion-input #name="ngModel" label="{{ 'menu.contact_tab.name' | translate }}*" name="name"
                                     ngModel
                                     placeholder="{{ 'menu.contact_tab.input' | translate }}">
                          </ion-input>
                        </ion-item>
                        <ion-item>
                          <ion-input #email="ngModel" email label="{{ 'menu.contact_tab.email' | translate }}*"
                                     name="email" ngModel
                                     placeholder="{{ 'menu.contact_tab.input' | translate }}">
                          </ion-input>
                        </ion-item>
                        <ion-item>
                          <ion-textarea #messages="ngModel" label="{{ 'menu.contact_tab.message' | translate }}"
                                        name="messages" ngModel
                                        placeholder="{{ 'menu.contact_tab.input_type' | translate }}"
                                        required="true">
                          </ion-textarea>
                        </ion-item>
                      </ion-list>
                      <ion-row>
                        <ion-col size="4"></ion-col>
                        <ion-col size="8" style="text-align: center">{{ 'menu.contact_tab.disclaimer' | translate }}<a
                          href="https://www.termsfeed.com/live/151fd6fb-dbc5-40e0-98a8-a546e6bd4989">Privacy Policy</a>
                        </ion-col>
                      </ion-row>
                      <ion-item lines="none">
                        <ion-button class="grad2" color="none" style="width: 100%; display: inline-block;"
                                    type="submit">
                          {{ 'menu.contact_tab.submit' | translate }}
                        </ion-button>
                      </ion-item>
                    </form>
                  </ion-content>
                </ng-template>
              </ion-modal>
            </ion-col>
          </ion-row>
        </ion-card>
      </ion-col>
      <ion-col *ngIf="quizList[level] && startBtnClicked" offset-md="2" size-md="8">
        <ion-card [ngClass]="isDesktop() ? '': 'mobileCard'">
          <ion-card-title style="{{'background: border-radius: 5px;'}}">
            <ion-card
              [ngStyle]="{'background': isWinning ? 'orange' : ''}"
              disabled="{{!active}}"
              id="questionCard">
              <ion-card-header>
                <ion-card-title style="--color: white; {{ isDesktop() ? '' : 'font-size: 14px;' }}">
                  {{quizList[level]?.value }}
                </ion-card-title>
              </ion-card-header>
            </ion-card>
          </ion-card-title>
          <ion-card-subtitle>
          </ion-card-subtitle>

          <ion-card-content>

            <ion-row>
              <ion-col size="6">

                <ion-button
                  (click)="selectAnswer(quizList[level].answers[0])" *ngIf="quizList[level].answers[0]"
                  [ngClass]="getAnswerClass(quizList[level].answers[0])"
                  class="ion-text-wrap ion-text-left"
                  color="none"
                  disabled="{{!active}}" expand="block"
                  style="height: 100%;"
                >
                  <ion-badge *ngIf="Object.keys(statDict).length"
                             slot="start">{{  getStat(quizList[level].answers[0]).toString().length < 2 ? getStat(quizList[level].answers[0]) + " % " : getStat(quizList[level].answers[0]) + "%" }}</ion-badge>
                  <ion-icon *ngIf="usePhone && quizList[level].answers[0] === quizList[level]?.correct_answer "
                            name="call"></ion-icon>
                  <span class="ion-text-wrap"
                        style="{{ isDesktop() ? 'contain: none;' : 'font-size: 11px; contain: none;' }}"

                  >{{['A: ', 'B: ', 'C: ', 'D: '][quizList[level].answers.indexOf(quizList[level].answers[0])] + quizList[level].answers[0]}}</span>
                </ion-button>
              </ion-col>
              <ion-col size="6">
                <ion-button (click)="selectAnswer(quizList[level].answers[1])" *ngIf="quizList[level].answers[1]"
                            [ngClass]="getAnswerClass(quizList[level].answers[1])"
                            class="ion-text-wrap ion-text-left"
                            color="none" disabled="{{!active}}"
                            expand="block"
                            style="height: 100%;"

                >
                  <ion-badge *ngIf="Object.keys(statDict).length"
                             slot="start">{{  getStat(quizList[level].answers[1]).toString().length < 2 ? getStat(quizList[level].answers[1]) + " % " : getStat(quizList[level].answers[1]) + "%" }}</ion-badge>
                  <ion-icon *ngIf="usePhone && quizList[level].answers[1] === quizList[level]?.correct_answer "
                            name="call"></ion-icon>
                  <span class="ion-text-wrap"
                        style="{{ isDesktop() ? 'contain: none;' : 'font-size: 11px; contain: none;' }}"

                  >{{['A: ', 'B: ', 'C: ', 'D: '][quizList[level].answers.indexOf(quizList[level].answers[1])] + quizList[level].answers[1]}}</span>


                </ion-button>
              </ion-col>
            </ion-row>

            <ion-row>
              <ion-col size="6">
                <ion-button (click)="selectAnswer(quizList[level].answers[2])" *ngIf="quizList[level].answers[2]"
                            [ngClass]="getAnswerClass(quizList[level].answers[2])"
                            class="ion-text-left ion-text-wrap"
                            color="none" disabled="{{!active}}"
                            expand="block"
                            style="height: 100%;"

                >
                  <ion-badge *ngIf="Object.keys(statDict).length"
                             slot="start">{{  getStat(quizList[level].answers[2]).toString().length < 2 ? getStat(quizList[level].answers[2]) + " % " : getStat(quizList[level].answers[2]) + "%" }}</ion-badge>
                  <ion-icon *ngIf="usePhone && quizList[level].answers[2] === quizList[level]?.correct_answer "
                            name="call"></ion-icon>
                  <span class="ion-text-wrap"
                        style="{{ isDesktop() ? 'contain: none;' : 'font-size: 11px; contain: none;' }}"
                  >{{['A: ', 'B: ', 'C: ', 'D: '][quizList[level].answers.indexOf(quizList[level].answers[2])] + quizList[level].answers[2]}}</span>
                </ion-button>
              </ion-col>
              <ion-col size="6">
                <ion-button (click)="selectAnswer(quizList[level].answers[3])" *ngIf="quizList[level].answers[3]"
                            [ngClass]="getAnswerClass(quizList[level].answers[3])"
                            class="ion-text-left ion-text-wrap"
                            color="none" disabled="{{!active}}"
                            expand="block"

                            style="height: 100%;">
                  <ion-badge *ngIf="Object.keys(statDict).length"
                             slot="start">{{  getStat(quizList[level].answers[3]).toString().length < 2 ? getStat(quizList[level].answers[3]) + " % " : getStat(quizList[level].answers[3]) + "%" }}</ion-badge>
                  <ion-icon *ngIf="usePhone && quizList[level].answers[3] === quizList[level]?.correct_answer "
                            name="call"></ion-icon>
                  <span class="ion-text-wrap"
                        style="{{ isDesktop() ? 'contain: none;' : 'font-size: 11px; contain: none;' }}"
                  >{{['A: ', 'B: ', 'C: ', 'D: '][quizList[level].answers.indexOf(quizList[level].answers[3])] + quizList[level].answers[3]}}</span>
                </ion-button>
              </ion-col>
            </ion-row>
          </ion-card-content>
          <ion-card-content>
            <ion-row>
              <ion-col size="{{isDesktop() ? '' : '8'  }}">
                <ion-button (click)="halving()"
                            *ngIf=" quizList[level].value !== 'Fail' && !isWinning "
                            class="ion-align-self-end help-button"
                            color="none"
                            disabled="{{!active || !help_modules['halving'] || pendingAnswer}}"
                            matTooltip="{{ getTooltip('halving') }}"
                            matTooltipPosition="above" size="small"
                >50:50
                </ion-button>
                <ion-button (click)="phone()"
                            *ngIf=" quizList[level].value !== 'Fail' && !isWinning"
                            class="ion-align-self-end help-button"
                            color="none"
                            disabled="{{!active || !help_modules['phone'] || pendingAnswer}}"
                            matTooltip="{{ getTooltip('phone') }}"
                            matTooltipPosition="above"
                            size="small"
                >
                  <ion-icon name="call"></ion-icon>
                </ion-button>
                <ion-button (click)="audience()"
                            *ngIf=" quizList[level].value !== 'Fail' && !isWinning"
                            class="ion-align-self-end help-button"
                            color="none"
                            disabled="{{!active || !help_modules['audience'] || pendingAnswer}}"
                            matTooltip="{{ getTooltip('audience') }}"
                            matTooltipPosition="above"
                            size="small"
                >
                  <ion-icon name="person"></ion-icon>
                  <ion-icon name="person"></ion-icon>
                  <ion-icon name="person"></ion-icon>
                </ion-button>
              </ion-col>
              <ion-col offset-md="2" size-md="3">
                <ion-button (click)="checkAnswer(selectedAnswer)"
                            *ngIf=" quizList[level]?.value !== 'Fail' && !isWinning && active"
                            class="grad2" color="none"
                            disabled="{{pendingAnswer}}"
                            size="small"
                            style="width: 100%; display: inline-block;">{{ 'quiz.next' | translate }}
                </ion-button>
              </ion-col>
            </ion-row>
          </ion-card-content>
          <ion-card-content
            *ngIf=" !active && quizList[level] || isWinning || networkError !=='';"
          >
            <ion-button (click)="reloadPage()" class="grad2" color="none"
                        style="width: 100%; display:inline-block;">
              <ion-icon name="reload" style="margin-right: 5px"></ion-icon>
              {{ 'quiz.try_again' | translate }}

            </ion-button>
          </ion-card-content>
        </ion-card>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
