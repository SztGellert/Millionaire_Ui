<ion-content [fullscreen]="true">
  <ion-header>
    <ion-toolbar>
      <ion-buttons *ngIf="!isMobileScreen()" slot="secondary">
        <ion-button (click)="allowMusic ? stopMusic() : playMusic()"
                    [ngClass]="allowMusic ? '' : 'inactive-chip' ">
          <ion-icon [ngClass]="allowMusic ? '' : 'music-icon'"
                    name="musical-notes" slot="icon-only"></ion-icon>
        </ion-button>
        <ion-button (click)="allowSounds ? allowSounds = false : allowSounds = true"
                    [ngClass]="allowSounds ? '' : 'inactive-chip' ">
          <ion-icon name="{{allowSounds ? 'volume-high' :  'volume-mute'}}" slot="icon-only"></ion-icon>
        </ion-button>
        <ion-button (click)="setLanguage('en')" [ngClass]="quiz_language === 'en' ? '' : 'inactive-chip' ">
          <ion-icon class="fi fi-gb" slot="icon-only"></ion-icon>
        </ion-button>
        <ion-button (click)="setLanguage('de')" [ngClass]="quiz_language === 'de' ? '' : 'inactive-chip' ">
          <ion-icon class="fi fi-de" slot="icon-only"></ion-icon>
        </ion-button>
        <ion-button (click)="setLanguage('hu')" [ngClass]="quiz_language === 'hu' ? '' : 'inactive-chip' ">
          <ion-icon class="fi fi-hu" slot="icon-only"></ion-icon>
        </ion-button>
      </ion-buttons>
      <ion-buttons (click)="!showToolbar ? showToolbar = true : showToolbar = false "
                   *ngIf="isMobileScreen() && !showToolbar"
                   slot="primary">
        <ion-button>
          <ion-icon ios="ellipsis-horizontal" md="ellipsis-vertical" slot="icon-only"></ion-icon>
        </ion-button>
      </ion-buttons>
      <ion-title (click)="reloadPage()" class="millionaire-header">
        <span>{{ 'app.title' | translate }}</span>
      </ion-title>
    </ion-toolbar>
    <ion-toolbar *ngIf="showToolbar && isMobileScreen()">
      <ion-buttons slot="start">
        <ion-button (click)="allowMusic ? stopMusic() : playMusic()"
                    [ngClass]="allowMusic ? '' : 'inactive-chip' ">
          <ion-icon [ngClass]="allowMusic ? '' : 'music-icon'"
                    name="musical-notes" slot="icon-only"></ion-icon>
        </ion-button>
        <ion-button (click)="allowSounds ? allowSounds = false : allowSounds = true"
                    [ngClass]="allowSounds ? '' : 'inactive-chip' ">
          <ion-icon name="{{allowSounds ? 'volume-high' :  'volume-mute'}}" slot="icon-only"></ion-icon>
        </ion-button>
        <ion-button (click)="setLanguage('en')" [ngClass]="quiz_language === 'en' ? '' : 'inactive-chip' ">
          <ion-icon class="fi fi-gb" slot="icon-only"></ion-icon>
        </ion-button>
        <ion-button (click)="setLanguage('de')" [ngClass]="quiz_language === 'de' ? '' : 'inactive-chip' ">
          <ion-icon class="fi fi-de" slot="icon-only"></ion-icon>
        </ion-button>
        <ion-button (click)="setLanguage('hu')" [ngClass]="quiz_language === 'hu' ? '' : 'inactive-chip' ">
          <ion-icon class="fi fi-hu" slot="icon-only"></ion-icon>
        </ion-button>
      </ion-buttons>
      <ion-buttons (click)="!showToolbar ? showToolbar = true : showToolbar = false "
                   *ngIf="isMobileScreen()"
                   slot="primary">
        <ion-button>
          <ion-icon ios="chevron-up-outline" md="chevron-up-outline" slot="icon-only"></ion-icon>
        </ion-button>
      </ion-buttons>
    </ion-toolbar>
  </ion-header>
  <ion-alert
    [isOpen]="isAlertOpen"
    class="{{!active ? 'redalert' : 'cssalert'}}"
    header="{{active ? getPrize() :  'quiz.incorrect_answer' | translate: {prize: getPrize()} }}"
  >
  </ion-alert>
  <ion-alert
    [isOpen]="isWinning"
    class="{{'cssalert'}}"
    header="{{'quiz.won' | translate: {prize: prizesList[14]} }}"
  >
  </ion-alert>
  <ion-grid>
    <ion-row>
      <ng-container *ngIf="networkError">
        <ion-header>
          <ion-toolbar>
            <ion-row>
              <ion-title color="warning">
                <ion-col>
                  <ion-icon name="cloud-offline-outline" size="large"></ion-icon>
                </ion-col>
                <ion-col>{{'app.network_error' | translate}}</ion-col>
              </ion-title>
            </ion-row>
          </ion-toolbar>
        </ion-header>
      </ng-container>
      <ion-col *ngIf="level===0 && !startBtnClicked" offset-md="2" size-md="8" style="fill: #56ab2f">
        <ion-card [ngClass]="isDesktop() ? '': 'mobileCard'">
          <ion-row *ngIf="level===0 && !startBtnClicked">
            <ion-col offset-md="4" size-md="4">
              <ion-img
                src="././assets/millionaire.png"
                style="width: auto;">
              </ion-img>
              <ion-button (click)="startQuiz()" *ngIf="level===0 && !startBtnClicked && networkError ==='' "
                          class="btn-grad"
                          color="none"
                          id="startBtn"
              >{{ 'menu.start' | translate }}

              </ion-button>
              <ion-button (click)="!showTopicActionSheet ? showTopicActionSheet = true : ''"
                          *ngIf="level===0 && !startBtnClicked && networkError ==='' "
                          class="btn-grad"
                          color="none"
              >{{ 'menu.select_topic' | translate }}
              </ion-button>
              <ion-button (click)="!showDifficultyActionSheet ? showDifficultyActionSheet = true : ''"
                          *ngIf="level===0 && !startBtnClicked && networkError ==='' "
                          class="btn-grad"
                          color="none"
              >{{ 'menu.select_difficulty' | translate }}
              </ion-button>
              <ion-button (click)="!feedbackModal ? feedbackModal = true : '';"
                          *ngIf="level===0 && !startBtnClicked && networkError ==='' "
                          class="btn-grad"
                          color="none"
              >{{ 'menu.contact' | translate }}

              </ion-button>
              <ion-action-sheet
                (click)="logResult($event)"
                (didDismiss)="showTopicActionSheet=false"
                [buttons]="topicActionSheetButtons"
                header="   {{ 'menu.topic_header' | translate }}"
                id="actionSheet"
                isOpen="{{showTopicActionSheet}}"
              ></ion-action-sheet>
              <ion-action-sheet
                (click)="logResult($event)"
                (didDismiss)="showDifficultyActionSheet=false"
                [buttons]="difficultyActionSheetButtons"
                header="   {{ 'menu.difficulty_header' | translate }}"
                isOpen="{{showDifficultyActionSheet}}"
              ></ion-action-sheet>
              <ion-modal (didDismiss)="setOpen(false)" [isOpen]="feedbackModal"
              >
                <ng-template>
                  <ion-header>
                    <ion-toolbar>
                      <ion-title>{{ 'menu.contact_tab.title' | translate }}</ion-title>
                      <ion-buttons slot="end">
                        <ion-button (click)="setOpen(false)">{{ 'menu.cancel' | translate }}</ion-button>
                      </ion-buttons>
                    </ion-toolbar>
                  </ion-header>
                  <ion-content>
                    <ion-card class="feedBackCard">
                      <ion-card-header style="font-size: 1rem; border-radius: 5px; --color: white; text-align: center">
                        {{ 'menu.contact_tab.description' | translate }}
                      </ion-card-header>
                    </ion-card>
                    <form #contactForm="ngForm" (ngSubmit)="onSubmit(contactForm)" class="ion-padding-horizontal">
                      <ion-list>
                        <ion-item class="ion-content">
                          <ion-input #name="ngModel" label="{{ 'menu.contact_tab.name' | translate }}"
                                     label-placement="floating" name="name"
                                     ngModel
                                     placeholder="{{ 'menu.contact_tab.input' | translate }}">
                          </ion-input>
                        </ion-item>
                        <ion-item class="ion-padding-end">
                          <ion-input #email="ngModel" email
                                     label="{{ 'menu.contact_tab.email' | translate }}"
                                     label-placement="floating"
                                     name="email" ngModel
                                     placeholder="{{ 'menu.contact_tab.input' | translate }}">
                          </ion-input>
                        </ion-item>
                        <ion-item class="ion-padding-end">
                          <ion-textarea #messages="ngModel"
                                        label="{{ 'menu.contact_tab.message' | translate }}"
                                        label-placement="floating"
                                        name="messages" ngModel
                                        placeholder="{{ 'menu.contact_tab.input_type' | translate }}"
                                        required="true">
                          </ion-textarea>
                        </ion-item>
                      </ion-list>

                      <div class="ion-float-end ion-padding">{{ 'menu.contact_tab.disclaimer' | translate }}<a
                        href="https://www.termsfeed.com/live/151fd6fb-dbc5-40e0-98a8-a546e6bd4989">Privacy
                        Policy</a>
                      </div>

                      <ion-item class="ion-align-self-end" lines="none"
                                style="position: fixed;left: 0; bottom: 10px; right: 0; --background: none;">
                        <ion-button class="grad2" color="none"
                                    style="text-transform: none; width: 100%; box-shadow: none;"
                                    type="submit">
                          {{ 'menu.contact_tab.submit' | translate }}
                        </ion-button>
                      </ion-item>
                    </form>
                  </ion-content>
                </ng-template>
              </ion-modal>
            </ion-col>
          </ion-row>
        </ion-card>
      </ion-col>
      <ion-col *ngIf="quizList[level] && startBtnClicked" offset-md="2" size-md="8">
        <ion-card [ngClass]="isDesktop() ? '': 'mobileCard'">
          <ion-card-title style="{{'background: border-radius: 5px;'}}">
            <ion-card
              [ngStyle]="{'background': isWinning ? 'orange' : ''}"
              disabled="{{!active}}"
              id="questionCard">
              <ion-card-header>
                <ion-card-title style="--color: white; {{ isDesktop() ? '' : 'font-size: 14px;' }}">
                  {{quizList[level]?.value }}
                </ion-card-title>
              </ion-card-header>
            </ion-card>
          </ion-card-title>
          <ion-card-subtitle>
          </ion-card-subtitle>
          <ion-card-content class="help-content">
            <ion-row>
              <ion-col>
                <ion-button (click)="answerOutOfGame()"
                            *ngIf=" quizList[level].value !== 'Fail' && !isWinning && !outOfGame && active"
                            class="help-button ion-float-left"
                            color="none"
                            disabled="{{!active || pendingAnswer}}"
                            matTooltip="{{ getTooltip('stop') }}"
                            matTooltipPosition="above"
                            size="small"
                            style="float:right;"
                >
                  <ion-icon name="stop"></ion-icon>
                </ion-button>
                <ion-button (click)="halving()"
                            *ngIf=" quizList[level].value !== 'Fail' && !isWinning && !outOfGame && active"
                            class="help-button ion-float-right"
                            color="none"
                            disabled="{{!active || !help_modules['halving'] || pendingAnswer}}"
                            matTooltip="{{ getTooltip('halving') }}"
                            matTooltipPosition="above" size="small"
                >50:50
                </ion-button>
                <ion-button (click)="phone()"
                            *ngIf=" quizList[level].value !== 'Fail' && !isWinning && !outOfGame && active"
                            class="help-button ion-float-right"
                            color="none"
                            disabled="{{!active || !help_modules['phone'] || pendingAnswer}}"
                            matTooltip="{{ getTooltip('phone') }}"
                            matTooltipPosition="above"
                            size="small"
                >
                  <ion-icon name="call"></ion-icon>
                </ion-button>
                <ion-button (click)="audience()"
                            *ngIf=" quizList[level].value !== 'Fail' && !isWinning && !outOfGame && active"
                            class="help-button ion-float-right"
                            color="none"
                            disabled="{{!active || !help_modules['audience'] || pendingAnswer}}"
                            matTooltip="{{ getTooltip('audience') }}"
                            matTooltipPosition="above"
                            size="small"
                >
                  <ion-icon name="person"></ion-icon>
                  <ion-icon name="person"></ion-icon>
                  <ion-icon name="person"></ion-icon>
                </ion-button>
              </ion-col>
            </ion-row>
          </ion-card-content>
          <ion-card-content>
            <ion-row>
              <ion-col size="6">
                <ion-button
                  (click)="selectAnswer(quizList[level].answers[0])" *ngIf="quizList[level].answers[0]"
                  [ngClass]="getAnswerClass(quizList[level].answers[0])"
                  class="ion-text-wrap ion-text-left"
                  color="none"
                  disabled="{{!active}}" expand="block"
                  style="height: 100%;"
                >
                  <ion-badge *ngIf="Object.keys(statDict).length"
                             slot="start">{{  getStat(quizList[level].answers[0]).toString().length < 2 ? getStat(quizList[level].answers[0]) + " % " : getStat(quizList[level].answers[0]) + "%" }}</ion-badge>
                  <ion-icon *ngIf="usePhone && quizList[level].answers[0] === quizList[level]?.correct_answer "
                            name="call"></ion-icon>
                  <span class="ion-text-wrap"
                        style="{{ isDesktop() ? 'contain: none;' : 'font-size: 11px; contain: none;' }}"

                  >{{['A: ', 'B: ', 'C: ', 'D: '][quizList[level].answers.indexOf(quizList[level].answers[0])] + quizList[level].answers[0]}}</span>
                </ion-button>
              </ion-col>
              <ion-col size="6">
                <ion-button (click)="selectAnswer(quizList[level].answers[1])" *ngIf="quizList[level].answers[1]"
                            [ngClass]="getAnswerClass(quizList[level].answers[1])"
                            class="ion-text-wrap ion-text-left"
                            color="none" disabled="{{!active}}"
                            expand="block"
                            style="height: 100%;"

                >
                  <ion-badge *ngIf="Object.keys(statDict).length"
                             slot="start">{{  getStat(quizList[level].answers[1]).toString().length < 2 ? getStat(quizList[level].answers[1]) + " % " : getStat(quizList[level].answers[1]) + "%" }}</ion-badge>
                  <ion-icon *ngIf="usePhone && quizList[level].answers[1] === quizList[level]?.correct_answer "
                            name="call"></ion-icon>
                  <span class="ion-text-wrap"
                        style="{{ isDesktop() ? 'contain: none;' : 'font-size: 11px; contain: none;' }}"

                  >{{['A: ', 'B: ', 'C: ', 'D: '][quizList[level].answers.indexOf(quizList[level].answers[1])] + quizList[level].answers[1]}}</span>
                </ion-button>
              </ion-col>
            </ion-row>

            <ion-row>
              <ion-col size="6">
                <ion-button (click)="selectAnswer(quizList[level].answers[2])" *ngIf="quizList[level].answers[2]"
                            [ngClass]="getAnswerClass(quizList[level].answers[2])"
                            class="ion-text-left ion-text-wrap"
                            color="none" disabled="{{!active}}"
                            expand="block"
                            style="height: 100%;"

                >
                  <ion-badge *ngIf="Object.keys(statDict).length"
                             slot="start">{{  getStat(quizList[level].answers[2]).toString().length < 2 ? getStat(quizList[level].answers[2]) + " % " : getStat(quizList[level].answers[2]) + "%" }}</ion-badge>
                  <ion-icon *ngIf="usePhone && quizList[level].answers[2] === quizList[level]?.correct_answer "
                            name="call"></ion-icon>
                  <span class="ion-text-wrap"
                        style="{{ isDesktop() ? 'contain: none;' : 'font-size: 11px; contain: none;' }}"
                  >{{['A: ', 'B: ', 'C: ', 'D: '][quizList[level].answers.indexOf(quizList[level].answers[2])] + quizList[level].answers[2]}}</span>
                </ion-button>
              </ion-col>
              <ion-col size="6">
                <ion-button (click)="selectAnswer(quizList[level].answers[3])" *ngIf="quizList[level].answers[3]"
                            [ngClass]="getAnswerClass(quizList[level].answers[3])"
                            class="ion-text-left ion-text-wrap"
                            color="none" disabled="{{!active}}"
                            expand="block"

                            style="height: 100%;">
                  <ion-badge *ngIf="Object.keys(statDict).length"
                             slot="start">{{  getStat(quizList[level].answers[3]).toString().length < 2 ? getStat(quizList[level].answers[3]) + " % " : getStat(quizList[level].answers[3]) + "%" }}</ion-badge>
                  <ion-icon *ngIf="usePhone && quizList[level].answers[3] === quizList[level]?.correct_answer "
                            name="call"></ion-icon>
                  <span class="ion-text-wrap"
                        style="{{ isDesktop() ? 'contain: none;' : 'font-size: 11px; contain: none;' }}"
                  >{{['A: ', 'B: ', 'C: ', 'D: '][quizList[level].answers.indexOf(quizList[level].answers[3])] + quizList[level].answers[3]}}</span>
                </ion-button>
              </ion-col>
            </ion-row>
          </ion-card-content>
          <ion-card-content>
            <ion-row>
              <ion-col offset-md="8" size-md="4" size-xs="12">
                <ion-button (click)="checkAnswer(selectedAnswer)"
                            *ngIf=" quizList[level]?.value !== 'Fail' && !isWinning && active"
                            class="grad2" color="none"
                            disabled="{{pendingAnswer}}"
                            size="small"
                            style="width: 100%; display: inline-block;">{{ 'quiz.next' | translate }}
                </ion-button>
              </ion-col>
            </ion-row>
          </ion-card-content>
          <ion-card-content
            *ngIf=" !active && quizList[level] || isWinning || networkError !=='';"
          >
            <ion-button (click)="reloadPage()" class="grad2" color="none"
                        style="width: 100%; display:inline-block;">
              <ion-icon name="reload" style="margin-right: 5px"></ion-icon>
              {{ 'quiz.try_again' | translate }}
            </ion-button>
          </ion-card-content>
        </ion-card>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
